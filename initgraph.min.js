function init(e){var d=sigma.init($("#sigma-example")[0]).drawingProperties({defaultLabelColor:"#fff",defaultLabelSize:14,defaultLabelBGColor:"#000000",defaultLabelHoverColor:"#000000",labelThreshold:11,defaultEdgeType:"curve"}).graphProperties({minNodeSize:1,maxNodeSize:10,minEdgeSize:1.5,maxEdgeSize:1.5}).mouseProperties({maxRatio:32});window.sigInst=d;d.parseGexf("data/"+e);var o="#404040";var h="#404040";d._core.graph.edges.forEach(function(i){i.hidden=true});var k=d._core.graph.nodes[0];attr=k.attr.attributes;var n=-1;var c=-1;var j=-1;for(var g=0;g<attr.length;g+=1){if(attr[g].attr.indexOf("TITLE")!=-1){n=g}if(attr[g].attr.indexOf("LAT")!=-1){c=g}if(attr[g].attr.indexOf("LNG")!=-1){j=g}}window.latIdx=c;window.lngIdx=j;console.log("titleIdx:"+n+" latIdx:"+c+" lngIdx:"+j);if(n>-1){d._core.graph.nodes.forEach(function(i){i.label=i.attr.attributes[n].val})}var b=-1;d.iterNodes(function(i){b=(i.size>b?i.size:b)});var l=Array();var m=0;d._core.graph.nodes.forEach(function(i){color=i.color;if(!(l.hasOwnProperty(color))){l[color]=m;m++}i.group=l[color];i.attr.tcolor=i.color});$("#group_separation").change(function(){var i=1-parseFloat(document.getElementById("group_separation").value);d._core.graph.edges.forEach(function(q){if(q.source.group==null){console.log(q.source)}if(q.target.group==null){console.log(q.target)}if(q.source.group!=q.target.group){q.weight=i}})});var p=false;document.getElementById("stop-layout").addEventListener("click",function(){if(p){p=false;d.stopForceAtlas2();document.getElementById("stop-layout").childNodes[0].nodeValue="Start Layout"}else{p=true;d.startForceAtlas2();document.getElementById("stop-layout").childNodes[0].nodeValue="Stop Layout"}},true);document.getElementById("rescale-graph").addEventListener("click",function(){d.position(0,0,1).draw()},true);d.bind("downnodes",function(q){window.mye=q;var i=q.content;window.clicknodes=i;a(i)});var a=function(i){var r={};var q=[];d.iterEdges(function(u){if(i.indexOf(u.source)<0&&i.indexOf(u.target)<0){if(window.EdgeShowing){u.color=o;u.hidden=false}else{u.hidden=true}}else{u.color=u.source.color;u.hidden=false;r[u.source]=1;r[u.target]=1}}).iterNodes(function(u){if(!r[u.id]){if(!u.attr.grey){u.attr.true_color=u.color;u.color=h;u.attr.grey=1}}else{u.color=u.attr.grey?u.attr.true_color:u.color;u.attr.grey=0;q.push([u.id,u.label])}}).draw(2,2,2);var t=$("<ul>");var s=d.getNodes(i[0]);t.append("<li>"+s.displayX+" : "+s.displayY);q.sort(function(v,u){if(v[1]>u[1]){return 1}if(v[1]<u[1]){return -1}return 0}).forEach(function(u){t.append('<li id="'+u[0]+'">'+u[1]+"</li>")});AppObj.info_array=q;$("#info-panel").html(t).css({opacity:0.6});$("li").hover(function(){window.li=$(this);id=$(this)[0].id;console.log(id);$(this).css({"font-size":20,color:"#000","background-color":"rgba(255,255,255,150)"});d.iterNodes(function(u){if(u.id==id){u.color="#FFF";u.attr.tsize=u.size;u.size=u.size*3<b?u.size*3:b}}).draw(2,2,2)},function(){$(this).css({"font-size":14,color:"#fff","background-color":"rgba(0,0,0,0)"});id=$(this)[0].id;d.iterNodes(function(u){if(u.id==id){u.color=u.attr.tcolor;u.size=u.attr.tsize}}).draw(2,2,2)});$("li").click(function(){window.li=$(this);id=$(this)[0].id;console.log(id);d.iterNodes(function(u){u.color=u.attr.tcolor});f([id])})};var f=function(i){var s={};var r=AppObj.info_array;d.iterEdges(function(v){if(i.indexOf(v.source)<0&&i.indexOf(v.target)<0){}else{v.color=v.source.color;v.hidden=false;s[v.source]=1;s[v.target]=1}}).iterNodes(function(v){if(!s[v.id]){}else{v.color=v.attr.grey?v.attr.true_color:v.color;v.attr.grey=0;r.push([v.id,v.label])}}).draw(2,2,2);var q=function(v){for(g=1;g<v.length;){if(v[g-1][1]==v[g][1]){v.splice(g,1)}else{g++}}return v};var u=$("<ul>");var t=d.getNodes(i[0]);u.append("<li>"+t.displayX+" : "+t.displayY);r.sort(function(w,v){if(w[1]>v[1]){return 1}if(w[1]<v[1]){return -1}return 0});r=q(r).forEach(function(v){u.append('<li id="'+v[0]+'">'+v[1]+"</li>")});$("#info-panel").html(u).css({opacity:0.6});$("li").hover(function(){window.li=$(this);id=$(this)[0].id;console.log(id);$(this).css({"font-size":20,color:"#000","background-color":"rgba(255,255,255,150)"});d.iterNodes(function(v){if(v.id==id){v.color="#FFF";v.attr.tsize=v.size;v.size=v.size*3<b?v.size*3:b}}).draw(2,2,2)},function(){$(this).css({"font-size":14,color:"#fff","background-color":"rgba(0,0,0,0)"});id=$(this)[0].id;d.iterNodes(function(v){if(v.id==id){v.color=v.attr.tcolor;v.size=v.attr.tsize}}).draw(2,2,2)});$("li").click(function(){window.li=$(this);id=$(this)[0].id;console.log(id);d.iterNodes(function(v){v.color=v.attr.tcolor});f([id])})};d.bind("downgraph",function(){d.iterNodes(function(i){i.color=i.attr.grey?i.attr.true_color:i.color;i.attr.grey=0}).iterEdges(function(i){i.color=i.source.color;if(window.EdgeShowing){i.hidden=false}else{i.hidden=true}}).draw(2,2,2);$("#info-panel").html("").css({opacity:0})});$("#info-panel").html("").css({opacity:0});(function(){var q;function r(t){var v=["GEOHASH","TITLE","weighted degree","modularity","component","eccent","closness","between"];function u(w){res=true;v.forEach(function(x){if(w.indexOf(x)>-1){res=false}});return res}return"<ul>"+t.map(function(w){if(u(w.attr)){return("<li>"+w.attr+" : "+w.val+"</li>")}}).join("")+"</ul>"}var s=function(u){q&&q.remove();var t;d.iterNodes(function(v){t=v},[u.content[0]]);q=$('<div class="node-info-popup"></div>').append(r(t.attr["attributes"])).attr("id","node-info"+d.getID()).css({display:"inline-block","border-radius":3,padding:5,background:"#fff",color:"#111","box-shadow":"0 0 4px #666",position:"absolute",left:t.displayX,top:t.displayY+15});window.popUp0=q;$("ul",q).css("margin","0 0 0 20px");$("#sigma-example").append(q)};AppObj.showNodeInfo=s;var i=function(t){q&&q.remove();q=false};AppObj.hideNodeInfo=i;d.bind("overnodes",s).bind("outnodes",i).draw()})();d.dispatch("downgraph")};